"use client";

import React, { useRef, useState } from "react";
import Image from "next/image";

import Tab from "react-bootstrap/Tab";
import Tabs from "react-bootstrap/Tabs";
import Link from "next/link";

import BookingTop from "../../../../../public/images/detail-imags-1.jpg";
import BookBtn from "../../../../../public/images/book-btn.png";
import { MyBooking, MyBookingState } from "@/store/features/accommodation/types/myBookingTypes";
import { useAppSelector } from "@/store/hooks";
import { useRouter } from "next/navigation";
import { formatDate } from "@/utils/formatData";
import UpComingTab from "./UpComingTab";
import ActiveTab from "./ActiveTab";
import CheckedOutTab from "./CheckedOutTab";
import getDateNGuest from "../../DateNGuest";

const CancelledTab = () => {
  const router = useRouter();
  const { cancelled } = useAppSelector((state) => state.myBookings.data);

  return (
    <div className="row">
      {cancelled.length > 0 &&
        cancelled.map((item) => {
          const { cancellationReason } = item;
          const { name, address, city, state, country, latitude, longitude } =
            item.hotel;
          return (
            <div key={item.id} className="col-md-12 mb-3 mb-2">
              <div className="mybooking-tab bg-white rounded-radius alert-box-magssage">
                <div className="book-again-box d-flex align-items-end justify-content-between flex-wrap gap-2">
                  <div className="book-again-left d-flex align-items-center gap-2">
                    <div className="book-again-img-box">
                    <Image src={item?.primaryImage?.url} alt="hotel image" height={80} width={80}></Image>
                    </div>
                    <div className="book-again-text-box">
                      <h4>
                        {name} 
                      </h4>
                      <h5>
                        {getDateNGuest(
                          item.startDate,
                          item.endDate,
                          item.adultsCount,
                          item.childrenCount,
                          item.specialCareCount
                        )}
                      </h5>
                      <h5> {address} {city}, {state} </h5>
                    </div>
                  </div>
                  <div className="right-box-cancelled  d-flex align-items-center gap-2 flex-wrap">
                    {cancellationReason !== null ? (
                      <>
                        <div className="mid-box">
                          <div className="red-alert-box">
                            <svg
                              width="21"
                              height="20"
                              viewBox="0 0 21 20"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                            >
                              <path
                                d="M11.3332 7.5013C11.3332 7.72232 11.2454 7.93428 11.0891 8.09056C10.9328 8.24684 10.7209 8.33464 10.4998 8.33464C10.2788 8.33464 10.0669 8.24684 9.91058 8.09056C9.7543 7.93428 9.6665 7.72232 9.6665 7.5013C9.6665 7.28029 9.7543 7.06833 9.91058 6.91205C10.0669 6.75577 10.2788 6.66797 10.4998 6.66797C10.7209 6.66797 10.9328 6.75577 11.0891 6.91205C11.2454 7.06833 11.3332 7.28029 11.3332 7.5013ZM10.4998 9.79297C10.6656 9.79297 10.8246 9.85882 10.9418 9.97603C11.059 10.0932 11.1248 10.2522 11.1248 10.418V14.5846C11.1248 14.7504 11.059 14.9094 10.9418 15.0266C10.8246 15.1438 10.6656 15.2096 10.4998 15.2096C10.3341 15.2096 10.1751 15.1438 10.0579 15.0266C9.94069 14.9094 9.87484 14.7504 9.87484 14.5846V10.418C9.87484 10.2522 9.94069 10.0932 10.0579 9.97603C10.1751 9.85882 10.3341 9.79297 10.4998 9.79297Z"
                                fill="#E03C22"
                              />
                              <path
                                fillRule="evenodd"
                                clipRule="evenodd"
                                d="M12.3914 3.32622C12.181 3.01857 11.8988 2.76687 11.5692 2.59295C11.2395 2.41903 10.8725 2.32812 10.4998 2.32813C10.1271 2.32812 9.75998 2.41903 9.43034 2.59295C9.10071 2.76687 8.81847 3.01857 8.60809 3.32622L8.24809 3.85288C5.99323 7.15223 4.0557 10.6576 2.46143 14.3221L2.38643 14.4954C2.2556 14.7957 2.19715 15.1226 2.21579 15.4497C2.23443 15.7768 2.32965 16.0949 2.49376 16.3785C2.65787 16.662 2.88628 16.903 3.16061 17.0821C3.43493 17.2612 3.74749 17.3734 4.07309 17.4096C8.34423 17.8871 12.6553 17.8871 16.9264 17.4096C17.252 17.3734 17.5646 17.2612 17.8389 17.0821C18.1132 16.903 18.3417 16.662 18.5058 16.3785C18.6699 16.0949 18.7651 15.7768 18.7837 15.4497C18.8024 15.1226 18.7439 14.7957 18.6131 14.4954L18.5381 14.3221C16.9438 10.6576 15.0063 7.15223 12.7514 3.85288L12.3914 3.32622ZM9.63976 4.03122C9.73538 3.89132 9.86368 3.77685 10.0135 3.69776C10.1634 3.61866 10.3303 3.57732 10.4998 3.57732C10.6692 3.57732 10.8361 3.61866 10.986 3.69776C11.1358 3.77685 11.2641 3.89132 11.3598 4.03122L11.7198 4.55788C13.9303 7.79186 15.8293 11.2281 17.3914 14.8204L17.4664 14.9937C17.5192 15.1146 17.5428 15.2462 17.5354 15.3778C17.528 15.5095 17.4898 15.6376 17.4238 15.7518C17.3577 15.866 17.2658 15.963 17.1554 16.0352C17.045 16.1073 16.9192 16.1525 16.7881 16.1671C12.6089 16.6337 8.39059 16.6337 4.21143 16.1671C4.08027 16.1526 3.95436 16.1075 3.84384 16.0354C3.73332 15.9633 3.6413 15.8663 3.57519 15.7521C3.50909 15.6379 3.47077 15.5098 3.46331 15.378C3.45585 15.2463 3.47947 15.1146 3.53226 14.9937L3.60726 14.8204C5.17008 11.2282 7.06939 7.79209 9.27976 4.55788L9.63976 4.03122Z"
                                fill="#E03C22"
                              />
                            </svg>
                            <p>Service Partner rejected your booking</p>
                          </div>
                        </div>
                        <div className="right-box">
                          <div className="grey-box d-flex flex-wrap align-items-center justify-content-center">
                            <div className="heading-top-box w-100">
                              <p>Service Partner Remarks</p>
                            </div>
                            <div className="text-box w-100">
                              <p>{cancellationReason}</p>
                            </div>
                          </div>
                        </div>
                      </>
                    ) : (
                      <div className="book-again-right">
                        <Link
                           href={`/home/accommodation/details/${item.hotelId}`} 
                          className="btn-book d-flex flex-wrap align-items-center gap-2"
                        >
                          <svg
                            width="15"
                            height="15"
                            viewBox="0 0 15 15"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                          >
                            <path
                              d="M0.833008 7.50033C0.833008 4.98633 0.833008 3.72899 1.61434 2.94833C2.39567 2.16766 3.65234 2.16699 6.16634 2.16699H8.83301C11.347 2.16699 12.6043 2.16699 13.385 2.94833C14.1657 3.72966 14.1663 4.98633 14.1663 7.50033V8.83366C14.1663 11.3477 14.1663 12.605 13.385 13.3857C12.6037 14.1663 11.347 14.167 8.83301 14.167H6.16634C3.65234 14.167 2.39501 14.167 1.61434 13.3857C0.833674 12.6043 0.833008 11.3477 0.833008 8.83366V7.50033Z"
                              stroke="#652669"
                            />
                            <path
                              d="M4.16602 2.16699V1.16699M10.8327 2.16699V1.16699M1.16602 5.50033H13.8327"
                              stroke="#652669"
                              strokeLinecap="round"
                            />
                            <path
                              d="M11.5 10.8333C11.5 11.0101 11.4298 11.1797 11.3047 11.3047C11.1797 11.4298 11.0101 11.5 10.8333 11.5C10.6565 11.5 10.487 11.4298 10.3619 11.3047C10.2369 11.1797 10.1667 11.0101 10.1667 10.8333C10.1667 10.6565 10.2369 10.487 10.3619 10.3619C10.487 10.2369 10.6565 10.1667 10.8333 10.1667C11.0101 10.1667 11.1797 10.2369 11.3047 10.3619C11.4298 10.487 11.5 10.6565 11.5 10.8333ZM11.5 8.16667C11.5 8.34348 11.4298 8.51305 11.3047 8.63807C11.1797 8.7631 11.0101 8.83333 10.8333 8.83333C10.6565 8.83333 10.487 8.7631 10.3619 8.63807C10.2369 8.51305 10.1667 8.34348 10.1667 8.16667C10.1667 7.98986 10.2369 7.82029 10.3619 7.69526C10.487 7.57024 10.6565 7.5 10.8333 7.5C11.0101 7.5 11.1797 7.57024 11.3047 7.69526C11.4298 7.82029 11.5 7.98986 11.5 8.16667ZM8.16667 10.8333C8.16667 11.0101 8.09643 11.1797 7.9714 11.3047C7.84638 11.4298 7.67681 11.5 7.5 11.5C7.32319 11.5 7.15362 11.4298 7.0286 11.3047C6.90357 11.1797 6.83333 11.0101 6.83333 10.8333C6.83333 10.6565 6.90357 10.487 7.0286 10.3619C7.15362 10.2369 7.32319 10.1667 7.5 10.1667C7.67681 10.1667 7.84638 10.2369 7.9714 10.3619C8.09643 10.487 8.16667 10.6565 8.16667 10.8333ZM8.16667 8.16667C8.16667 8.34348 8.09643 8.51305 7.9714 8.63807C7.84638 8.7631 7.67681 8.83333 7.5 8.83333C7.32319 8.83333 7.15362 8.7631 7.0286 8.63807C6.90357 8.51305 6.83333 8.34348 6.83333 8.16667C6.83333 7.98986 6.90357 7.82029 7.0286 7.69526C7.15362 7.57024 7.32319 7.5 7.5 7.5C7.67681 7.5 7.84638 7.57024 7.9714 7.69526C8.09643 7.82029 8.16667 7.98986 8.16667 8.16667ZM4.83333 10.8333C4.83333 11.0101 4.7631 11.1797 4.63807 11.3047C4.51305 11.4298 4.34348 11.5 4.16667 11.5C3.98986 11.5 3.82029 11.4298 3.69526 11.3047C3.57024 11.1797 3.5 11.0101 3.5 10.8333C3.5 10.6565 3.57024 10.487 3.69526 10.3619C3.82029 10.2369 3.98986 10.1667 4.16667 10.1667C4.34348 10.1667 4.51305 10.2369 4.63807 10.3619C4.7631 10.487 4.83333 10.6565 4.83333 10.8333ZM4.83333 8.16667C4.83333 8.34348 4.7631 8.51305 4.63807 8.63807C4.51305 8.7631 4.34348 8.83333 4.16667 8.83333C3.98986 8.83333 3.82029 8.7631 3.69526 8.63807C3.57024 8.51305 3.5 8.34348 3.5 8.16667C3.5 7.98986 3.57024 7.82029 3.69526 7.69526C3.82029 7.57024 3.98986 7.5 4.16667 7.5C4.34348 7.5 4.51305 7.57024 4.63807 7.69526C4.7631 7.82029 4.83333 7.98986 4.83333 8.16667Z"
                              fill="#652669"
                            />
                          </svg>
                          <span>Book again</span>
                        </Link>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
          );
        })}

      {/* <div className="col-md-12 mb-3 mb-2">
        <div className="mybooking-tab bg-white rounded-radius alert-box-magssage">
          <div className="book-again-box d-flex align-items-end justify-content-between flex-wrap gap-2">
            <div className="book-again-left d-flex align-items-center gap-2">
              <div className="book-again-img-box">
                <Image alt="" src={BookBtn}></Image>
              </div>
              <div className="book-again-text-box">
                <h4>Accra Marriott Hotel, Ghana</h4>
                <h5>7 July - 8 July 2024 • 1 Guest</h5>
                <p>640 m drive to Accra Airport (ACC-Kotoka Intl.)</p>
              </div>
            </div>
            <div className="right-box-cancelled  d-flex align-items-center gap-2 flex-wrap">
              <div className="mid-box">
                <div className="red-alert-box">
                  <svg
                    width="21"
                    height="20"
                    viewBox="0 0 21 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M11.3332 7.5013C11.3332 7.72232 11.2454 7.93428 11.0891 8.09056C10.9328 8.24684 10.7209 8.33464 10.4998 8.33464C10.2788 8.33464 10.0669 8.24684 9.91058 8.09056C9.7543 7.93428 9.6665 7.72232 9.6665 7.5013C9.6665 7.28029 9.7543 7.06833 9.91058 6.91205C10.0669 6.75577 10.2788 6.66797 10.4998 6.66797C10.7209 6.66797 10.9328 6.75577 11.0891 6.91205C11.2454 7.06833 11.3332 7.28029 11.3332 7.5013ZM10.4998 9.79297C10.6656 9.79297 10.8246 9.85882 10.9418 9.97603C11.059 10.0932 11.1248 10.2522 11.1248 10.418V14.5846C11.1248 14.7504 11.059 14.9094 10.9418 15.0266C10.8246 15.1438 10.6656 15.2096 10.4998 15.2096C10.3341 15.2096 10.1751 15.1438 10.0579 15.0266C9.94069 14.9094 9.87484 14.7504 9.87484 14.5846V10.418C9.87484 10.2522 9.94069 10.0932 10.0579 9.97603C10.1751 9.85882 10.3341 9.79297 10.4998 9.79297Z"
                      fill="#E03C22"
                    />
                    <path
                      fillRule="evenodd"
                      clipRule="evenodd"
                      d="M12.3914 3.32622C12.181 3.01857 11.8988 2.76687 11.5692 2.59295C11.2395 2.41903 10.8725 2.32812 10.4998 2.32813C10.1271 2.32812 9.75998 2.41903 9.43034 2.59295C9.10071 2.76687 8.81847 3.01857 8.60809 3.32622L8.24809 3.85288C5.99323 7.15223 4.0557 10.6576 2.46143 14.3221L2.38643 14.4954C2.2556 14.7957 2.19715 15.1226 2.21579 15.4497C2.23443 15.7768 2.32965 16.0949 2.49376 16.3785C2.65787 16.662 2.88628 16.903 3.16061 17.0821C3.43493 17.2612 3.74749 17.3734 4.07309 17.4096C8.34423 17.8871 12.6553 17.8871 16.9264 17.4096C17.252 17.3734 17.5646 17.2612 17.8389 17.0821C18.1132 16.903 18.3417 16.662 18.5058 16.3785C18.6699 16.0949 18.7651 15.7768 18.7837 15.4497C18.8024 15.1226 18.7439 14.7957 18.6131 14.4954L18.5381 14.3221C16.9438 10.6576 15.0063 7.15223 12.7514 3.85288L12.3914 3.32622ZM9.63976 4.03122C9.73538 3.89132 9.86368 3.77685 10.0135 3.69776C10.1634 3.61866 10.3303 3.57732 10.4998 3.57732C10.6692 3.57732 10.8361 3.61866 10.986 3.69776C11.1358 3.77685 11.2641 3.89132 11.3598 4.03122L11.7198 4.55788C13.9303 7.79186 15.8293 11.2281 17.3914 14.8204L17.4664 14.9937C17.5192 15.1146 17.5428 15.2462 17.5354 15.3778C17.528 15.5095 17.4898 15.6376 17.4238 15.7518C17.3577 15.866 17.2658 15.963 17.1554 16.0352C17.045 16.1073 16.9192 16.1525 16.7881 16.1671C12.6089 16.6337 8.39059 16.6337 4.21143 16.1671C4.08027 16.1526 3.95436 16.1075 3.84384 16.0354C3.73332 15.9633 3.6413 15.8663 3.57519 15.7521C3.50909 15.6379 3.47077 15.5098 3.46331 15.378C3.45585 15.2463 3.47947 15.1146 3.53226 14.9937L3.60726 14.8204C5.17008 11.2282 7.06939 7.79209 9.27976 4.55788L9.63976 4.03122Z"
                      fill="#E03C22"
                    />
                  </svg>
                  <p>Service Partner rejected your booking</p>
                </div>
              </div>
              <div className="right-box">
                <div className="grey-box d-flex flex-wrap align-items-center justify-content-center">
                  <div className="heading-top-box w-100">
                    <p>Service Partner Remarks</p>
                  </div>
                  <div className="text-box w-100">
                    <p>this cuisine is not available at the moment</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div className="col-md-12 mb-3 mb-2">
        <div className="mybooking-tab bg-white rounded-radius">
          <div className="book-again-box d-flex align-items-end justify-content-between flex-wrap gap-2">
            <div className="book-again-left d-flex align-items-center gap-2">
              <div className="book-again-img-box">
                <Image alt="" src={BookBtn}></Image>
              </div>
              <div className="book-again-text-box">
                <h4>Accra Marriott Hotel, Ghana</h4>
                <h5>7 July - 8 July 2024 • 1 Guest</h5>
                <p>640 m drive to Accra Airport (ACC-Kotoka Intl.)</p>
              </div>
            </div>
            <div className="book-again-right">
              <Link
                href=""
                className="btn-book d-flex flex-wrap align-items-center gap-2"
              >
                <svg
                  width="15"
                  height="15"
                  viewBox="0 0 15 15"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M0.833008 7.50033C0.833008 4.98633 0.833008 3.72899 1.61434 2.94833C2.39567 2.16766 3.65234 2.16699 6.16634 2.16699H8.83301C11.347 2.16699 12.6043 2.16699 13.385 2.94833C14.1657 3.72966 14.1663 4.98633 14.1663 7.50033V8.83366C14.1663 11.3477 14.1663 12.605 13.385 13.3857C12.6037 14.1663 11.347 14.167 8.83301 14.167H6.16634C3.65234 14.167 2.39501 14.167 1.61434 13.3857C0.833674 12.6043 0.833008 11.3477 0.833008 8.83366V7.50033Z"
                    stroke="#652669"
                  />
                  <path
                    d="M4.16602 2.16699V1.16699M10.8327 2.16699V1.16699M1.16602 5.50033H13.8327"
                    stroke="#652669"
                    strokeLinecap="round"
                  />
                  <path
                    d="M11.5 10.8333C11.5 11.0101 11.4298 11.1797 11.3047 11.3047C11.1797 11.4298 11.0101 11.5 10.8333 11.5C10.6565 11.5 10.487 11.4298 10.3619 11.3047C10.2369 11.1797 10.1667 11.0101 10.1667 10.8333C10.1667 10.6565 10.2369 10.487 10.3619 10.3619C10.487 10.2369 10.6565 10.1667 10.8333 10.1667C11.0101 10.1667 11.1797 10.2369 11.3047 10.3619C11.4298 10.487 11.5 10.6565 11.5 10.8333ZM11.5 8.16667C11.5 8.34348 11.4298 8.51305 11.3047 8.63807C11.1797 8.7631 11.0101 8.83333 10.8333 8.83333C10.6565 8.83333 10.487 8.7631 10.3619 8.63807C10.2369 8.51305 10.1667 8.34348 10.1667 8.16667C10.1667 7.98986 10.2369 7.82029 10.3619 7.69526C10.487 7.57024 10.6565 7.5 10.8333 7.5C11.0101 7.5 11.1797 7.57024 11.3047 7.69526C11.4298 7.82029 11.5 7.98986 11.5 8.16667ZM8.16667 10.8333C8.16667 11.0101 8.09643 11.1797 7.9714 11.3047C7.84638 11.4298 7.67681 11.5 7.5 11.5C7.32319 11.5 7.15362 11.4298 7.0286 11.3047C6.90357 11.1797 6.83333 11.0101 6.83333 10.8333C6.83333 10.6565 6.90357 10.487 7.0286 10.3619C7.15362 10.2369 7.32319 10.1667 7.5 10.1667C7.67681 10.1667 7.84638 10.2369 7.9714 10.3619C8.09643 10.487 8.16667 10.6565 8.16667 10.8333ZM8.16667 8.16667C8.16667 8.34348 8.09643 8.51305 7.9714 8.63807C7.84638 8.7631 7.67681 8.83333 7.5 8.83333C7.32319 8.83333 7.15362 8.7631 7.0286 8.63807C6.90357 8.51305 6.83333 8.34348 6.83333 8.16667C6.83333 7.98986 6.90357 7.82029 7.0286 7.69526C7.15362 7.57024 7.32319 7.5 7.5 7.5C7.67681 7.5 7.84638 7.57024 7.9714 7.69526C8.09643 7.82029 8.16667 7.98986 8.16667 8.16667ZM4.83333 10.8333C4.83333 11.0101 4.7631 11.1797 4.63807 11.3047C4.51305 11.4298 4.34348 11.5 4.16667 11.5C3.98986 11.5 3.82029 11.4298 3.69526 11.3047C3.57024 11.1797 3.5 11.0101 3.5 10.8333C3.5 10.6565 3.57024 10.487 3.69526 10.3619C3.82029 10.2369 3.98986 10.1667 4.16667 10.1667C4.34348 10.1667 4.51305 10.2369 4.63807 10.3619C4.7631 10.487 4.83333 10.6565 4.83333 10.8333ZM4.83333 8.16667C4.83333 8.34348 4.7631 8.51305 4.63807 8.63807C4.51305 8.7631 4.34348 8.83333 4.16667 8.83333C3.98986 8.83333 3.82029 8.7631 3.69526 8.63807C3.57024 8.51305 3.5 8.34348 3.5 8.16667C3.5 7.98986 3.57024 7.82029 3.69526 7.69526C3.82029 7.57024 3.98986 7.5 4.16667 7.5C4.34348 7.5 4.51305 7.57024 4.63807 7.69526C4.7631 7.82029 4.83333 7.98986 4.83333 8.16667Z"
                    fill="#652669"
                  />
                </svg>
                <span>Book again</span>
              </Link>
            </div>
          </div>
        </div>
      </div> */}
    </div>
  );
};

export default CancelledTab;
